<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Oyebanji Akins Blog</title>
  <link rel="stylesheet" href="css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f8f9fa;
      padding-top: 80px;
    }

    .navbar {
      background-color: #5D4037;
    }

    .tweet-card,
    .blog-post-card {
      background-color: #fff;
      border: 2px solid #5D4037;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .tweet-header,
    .blog-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .tweet-header i,
    .blog-header i {
      color: #5D4037;
      margin-right: 8px;
    }

    .username {
      font-weight: bold;
      color: #5D4037;
    }

    .timestamp {
      font-size: 0.9em;
      color: #888;
    }

    .comments-section {
      margin-top: 10px;
    }

    .comment {
      background: #f1f1f1;
      border-radius: 5px;
      padding: 5px 10px;
      margin-top: 5px;
    }

    .comment small {
      display: block;
      font-size: 0.8em;
      color: #555;
    }

    .no-data {
      text-align: center;
      font-style: italic;
      color: #888;
    }
  </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
    <div class="container">
      <a class="navbar-brand" href="#">
        <img class="img-fluid" src="images/logo.png" alt="Logo" />
      </a>
    </div>
  </nav>

  <div class="container">
    <h2 class="text-center mb-4">Tweets & Blog Posts</h2>
    <div id="tweet-list"></div>
    <div id="blog-post-list"></div>
  </div>

  <script>
    const formatDate = (dateStr) => {
      const date = new Date(dateStr);
      return isNaN(date) ? '' : `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;
    };

    const loadContent = () => {
      const tweets = JSON.parse(localStorage.getItem("tweets") || "[]").filter(t => t && t.text).slice(-5).reverse();
      const blogs = JSON.parse(localStorage.getItem("blogs") || "[]").filter(b => b && b.title && b.content).slice(-5).reverse();

      const tweetList = document.getElementById("tweet-list");
      tweetList.innerHTML = tweets.length === 0 ? `<p class="no-data">No tweets yet.</p>` : tweets.map(tweet => `
        <div class="tweet-card">
          <div class="tweet-header">
            <div>
              <i class="fa-brands fa-x-twitter"></i>
              <span class="username">@Oyebanji_akins</span>
            </div>
            <div class="timestamp">${formatDate(tweet.date)}</div>
          </div>
          <p>${tweet.text}</p>
          <div class="comments-section">
            <strong>Comments:</strong>
            <div id="comments-tweet-${tweet.id}">
              ${(tweet.comments || []).map(c => `<div class="comment"><strong>${c.name}:</strong> ${c.text}</div>`).join("")}
            </div>
            <form onsubmit="addComment(event, 'tweet', '${tweet.id}')">
              <input type="text" placeholder="Your Name" required id="name-tweet-${tweet.id}" class="form-control mb-1">
              <input type="text" placeholder="Leave a comment..." required id="comment-tweet-${tweet.id}" class="form-control mb-1">
              <button class="btn btn-sm btn-outline-dark">Comment</button>
            </form>
          </div>
        </div>
      `).join("");

      const blogList = document.getElementById("blog-post-list");
      blogList.innerHTML = blogs.length === 0 ? `<p class="no-data">No blog posts yet.</p>` : blogs.map(post => `
        <div class="blog-post-card">
          <div class="blog-header">
            <div>
              <i class="fa-solid fa-newspaper"></i>
              <span class="username">Oyebanji Akins</span>
            </div>
            <div class="timestamp">${formatDate(post.date)}</div>
          </div>
          <h5 class="text-primary"><strong>${post.title}</strong></h5>
          <p>${post.content}</p>
          <div class="comments-section">
            <strong>Comments:</strong>
            <div id="comments-blog-${post.id}">
              ${(post.comments || []).map(c => `<div class="comment"><strong>${c.name}:</strong> ${c.text}</div>`).join("")}
            </div>
            <form onsubmit="addComment(event, 'blog', '${post.id}')">
              <input type="text" placeholder="Your Name" required id="name-blog-${post.id}" class="form-control mb-1">
              <input type="text" placeholder="Leave a comment..." required id="comment-blog-${post.id}" class="form-control mb-1">
              <button class="btn btn-sm btn-outline-dark">Comment</button>
            </form>
          </div>
        </div>
      `).join("");
    };

    const addComment = (e, type, id) => {
      e.preventDefault();
      const nameInput = document.getElementById(`name-${type}-${id}`);
      const commentInput = document.getElementById(`comment-${type}-${id}`);
      const comment = commentInput.value.trim();
      const name = nameInput.value.trim();

      if (!comment || !name) return;

      const key = type === 'tweet' ? 'tweets' : 'blogs';
      const data = JSON.parse(localStorage.getItem(key) || "[]");
      const index = data.findIndex(x => x.id === id);
      if (index === -1) return;

      data[index].comments = data[index].comments || [];
      data[index].comments.push({ name, text: comment });
      localStorage.setItem(key, JSON.stringify(data));

      commentInput.value = "";
      nameInput.value = "";
      loadContent();
    };

    window.onload = loadContent;
  </script>
</body>

</html>
